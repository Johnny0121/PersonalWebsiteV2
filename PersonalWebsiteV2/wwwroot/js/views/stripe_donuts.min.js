var stripeDonutModule=function(){function e(){$("#payment-form-container").hide();$("#stripe-submit").prop("disabled",!0);const t=$(".valueSpan"),n=$("#donation-slider");var r="£"+Number.parseFloat(n.val()).toFixed(2);t.html(r);n.on("input change",()=>{t.html("£"+Number.parseFloat(n.val()).toFixed(2)),i.amount=n.val()*100})}var t=Stripe("pk_test_51Ha85VCBa5lwqRr4DtLBAIp6CyIuD7URviKrOkHctcjZD0eGC5TMGcDRlzdKpYsZ9vM6v1QCBzwPjL9eBKa6gxzR006yktlLGT"),i={amount:1};$("#donation-continue").click(function(){const n={amount:i.amount*100};fetch("/api/PaymentIntent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(function(n){return $("#payment-form-container").show(),n.json()}).then(function(n){var f=t.elements(),i=f.create("card",{style:{base:{color:"#32325d",fontFamily:"Arial, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#32325d"}},invalid:{fontFamily:"Arial, sans-serif",color:"#fa755a",iconColor:"#fa755a"}}}),u;i.mount("#card-element");i.on("change",function(n){document.querySelector("#stripe-submit").disabled=n.empty;document.querySelector("#card-error").textContent=n.error?n.error.message:""});u=document.getElementById("payment-form");u.addEventListener("submit",function(u){u.preventDefault();r(t,i,n.clientSecret)})})});var r=function(t,i,r){n(!0);t.confirmCardPayment(r,{receipt_email:document.getElementById("email").value,payment_method:{card:i}}).then(function(n){n.error?f(n.error.message+" Don't worry, nothing has went through yet."):u(n.paymentIntent.id)})},u=function(t){n(!1);document.querySelector("#payment-intent-id").innerHTML=`Payment Intent ID: ${t}`;document.querySelector(".result-message").classList.remove("d-none");document.querySelector("#payment-success").classList.remove("d-none");document.querySelector("#payment-form").classList.add("d-none");document.querySelector("#payment-container").classList.add("d-none");document.querySelector("#stripe-submit").disabled=!0},f=function(t){n(!1);var i=document.querySelector("#card-error");i.textContent=t;setTimeout(function(){i.textContent=""},4e3)},n=function(n){n?(document.querySelector("#stripe-submit").disabled=!0,document.querySelector("#spinner").classList.remove("d-none"),document.querySelector("#button-text").classList.add("d-none")):(document.querySelector("#stripe-submit").disabled=!1,document.querySelector("#spinner").classList.add("d-none"),document.querySelector("#button-text").classList.remove("d-none"))};return{init:e}}();stripeDonutModule.init();